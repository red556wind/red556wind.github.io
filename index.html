<!DOCTYPE html>
<html lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trolldier Rankings</title>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-QHDB21ST3Z"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-QHDB21ST3Z');
</script>
<style>
  body { 
    background-image: url("images.jpg"); 
    color: #e5e5e5; 
    font-family: 'Arial', sans-serif; 
    margin:0; 
    padding:20px; 
    background-repeat: no-repeat;
    background-size: cover;
    background-attachment: fixed;
  }
  h1 { 
    text-align:center; 
    margin-bottom: 40px;
    font-size:2.2rem;
  }
  .list { 
    display: flex; 
    flex-direction: column; 
    gap: 18px;
    max-width: 600px; 
    margin: 0 auto; 
  }
  .card { 
    background:#1a1a1a; 
    border:1px solid #2a2a2a; 
    border-radius:10px; 
    padding:18px; 
    box-shadow:0 3px 7px rgba(0,0,0,0.5); 
    cursor:pointer; 
    transition: transform 0.15s; 
    text-decoration:none; 
    color: inherit; 
    display:block; 
  }
  .card:hover { 
    transform: scale(1.03); 
  }
  .card h2 { 
    color:#60a5fa; 
    margin-bottom:12px; 
    font-size:1.4rem; 
  }
  .info { 
    margin:8px 0; 
    font-size:0.95rem; 
  }
  .progress { 
    background:#2a2a2a; 
    border-radius:5px; 
    overflow:hidden; 
    height:10px; 
    margin-top:4px; 
  }
  .progress-bar { 
    background:#a855f7; 
    height:100%; 
  }
  .skill-text { 
    font-size:0.82rem; 
    color:#aaa; 
    margin-top:3px; 
  }
  a { 
    color:#60a5fa;
    text-decoration: underline;
  }
  a:hover {
    color:#93c5fd;
  }
  .textbox {
    background: rgba(0, 0, 0, 0.6);
    border: 1px solid #444;
    border-radius: 10px;
    padding: 20px;
    max-width: 600px;
    margin: 20px auto;
    color: #e5e5e5;
    font-size: 2rem;
    line-height: 1.6;
    text-align: center;
    box-shadow: 0 4px 10px rgba(0,0,0,0.5);
  }

  .textbox-pink {
  background: rgba(255, 105, 180, 0.6); /* pink with transparency */
  border: 1px solid #ff69b4;
  color: #fff;
}

  #totalSpoonKills {
    position: fixed;
    top: 2px;
    right: 20px;
    background: rgba(0, 0, 0, 0.7);
    border: 1px solid #444;
    padding: 12px 20px;
    border-radius: 100px;
    font-size: 1.1rem;
    color: #e5e5e5;
    z-index: 999;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
  }
  #totalHoursPlayed {
    position: fixed;
    top: 60px;
    right: 20px;
    background: rgba(0, 0, 0, 0.7);
    border: 1px solid #444;
    padding: 12px 11px;
    border-radius: 100px;
    font-size: 1.1rem;
    color: #e5e5e5;
    z-index: 999;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
  }
</style>
</head>
<body>
<h1>Trolldier Rankings</h1>

<div class="textbox">
  <p>This website is just for fun dont take anything seriously.</p>
  <p>
    <a href="https://github.com/red556wind/red556wind.github.io/tree/main">view the source code on GitHub</a>.
  </p>
  <p>
    If you want your profile added fill out this 
    <a href="https://forms.cloud.microsoft.com/Pages/ResponsePage.aspx?id=SbprGzVvgk2fykgn1BfNPvYhhn1aw5NMuCL4K5WlCShUMlRQTjcyOUNQTDgwSUVNNDFMRzRGUkVEVC4u">form</a>.
  </p>
  <p>
    Your score is calculated based on your jump map tier and amount of spoon kills, you can view the formula on GitHub.
  </p>
</div>
<div id="totalSpoonKills">Total Spoon Kills: 0</div>
<div id="totalHoursPlayed">Total Hours Played: 0</div>

<div class="list" id="playerList"></div>

<script>
document.addEventListener("DOMContentLoaded", function() {
  fetch('players_updated.json')
    .then(response => {
      if (!response.ok) throw new Error('Failed to load player data');
      return response.json();
    })
    .then(players => {
      // Same processing as before
      players.forEach(p => {
        const t = p.jumpTier;
        const cappedKills = Math.min(p.spoonKills, 100000);
        const k = cappedKills;
        let P = (15/100 * t/5 + 85/100 * Math.log(k+1)/15.69) * 100/77.37085179 * 100;
        p.skill = P.toFixed(2);
      });

      players.sort((a,b) => b.skill - a.skill);

      const list = document.getElementById('playerList');

      players.forEach((p, index) => {
        const cardLink = document.createElement('a');
        cardLink.href = p.profile;
        cardLink.target = "_blank";
        cardLink.className = 'card';
cardLink.innerHTML = `
  <h2>${index + 1}. ${p.name}</h2>
        <div class="info">Spoon Kills: ${p.spoonKills}</div>
        <div class="info">Jump Map Tier: ${p.jumpTier > 0 ? p.jumpTier : "No data"}</div>
        <div class="info">Community Votes: ${p.votes > 0 ? p.votes : "No data"}</div>
        <div class="info">Hours Played: ${p.hoursPlayed > 0 ? p.hoursPlayed : "No data"}</div>
        <div class="info">Overall Score:</div>
        <div class="progress"><div class="progress-bar" style="width:${p.skill}%"></div></div>
        <div class="skill-text">${p.skill}/100</div>
      `;
      if (p.name.toLowerCase() === "red556wind") {
          cardLink.classList.add("textbox-pink");
}

        list.appendChild(cardLink);
      });

      // Update totals
      const totalKills = players.reduce((sum, p) => sum + p.spoonKills, 0);
      document.getElementById("totalSpoonKills").textContent = `Total Spoon Kills: ${totalKills.toLocaleString()}`;

      const totalHours = players.reduce((sum, p) => sum + p.hoursPlayed, 0);
      document.getElementById("totalHoursPlayed").textContent = `Total Hours Played: ${totalHours.toLocaleString()}`;
    })
    .catch(error => {
      console.error('Error loading player data:', error);
      const list = document.getElementById('playerList');
      list.innerHTML = '<p style="color: red;">Failed to load player data.</p>';
    });
});

</script>

</body>
</html>
